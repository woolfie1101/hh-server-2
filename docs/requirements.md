# 📌 요구사항 기능 목록

## 0. 유저 인증 (로그인)
- 유저는 이메일/비밀번호로 로그인할 수 있다.
- 로그인 성공 시 JWT를 응답받고, 이후 모든 요청에 포함해 사용한다.
- 로그인된 유저만 대기열 토큰 발급 및 예약 기능을 사용할 수 있다.

## 1. 유저 대기열 토큰 발급
- 유저는 UUID 기반으로 대기열 토큰을 요청할 수 있다.
- 응답에는 대기열 순서 혹은 잔여 시간 등의 정보가 포함된다.
- 발급된 토큰은 이후 모든 API 호출에 사용된다.
- **제약조건**: 대기열을 통과한 유저만 기능을 사용할 수 있다.

---

## 2. 예약 가능 날짜 / 좌석 조회
- 유저는 예약 가능한 날짜 목록을 조회할 수 있다.
- 특정 날짜를 선택해, 해당 날짜에 예약 가능한 좌석 번호(1~50)를 조회할 수 있다.
- 좌석 상태는 "예약 가능", "임시 배정", "결제 완료" 등으로 나뉜다.

---

## 3. 좌석 예약 요청
- 유저는 날짜 + 좌석 번호를 입력해 좌석 예약을 요청할 수 있다.
- 요청이 성공하면 해당 좌석은 **임시 배정 상태(5분)**로 전환된다.
- **제약조건**:
  - 임시 배정 중인 좌석은 다른 유저가 접근 불가.
  - 지정된 시간(예: 5분) 내 결제가 완료되지 않으면 좌석은 해제된다.

---

## 4. 잔액 충전 및 조회
- 유저는 자신의 잔액을 조회할 수 있다.
- 유저는 충전 요청을 통해 잔액을 증가시킬 수 있다.
- **제약조건**: 결제를 위해 충분한 잔액이 필요하다.

---

## 5. 결제 처리
- 유저는 임시 배정된 좌석에 대해 결제를 진행할 수 있다.
- 결제가 성공하면:
  - 좌석 상태가 **예약 확정**으로 변경됨
  - 유저의 잔액이 차감됨
  - 해당 유저의 대기열 토큰은 만료됨
- 결제가 실패하거나 시간이 초과되면 좌석은 자동 해제됨

---

## 6. 예약 취소 / 만료
- 유저는 직접 임시 예약을 취소할 수 있다.
- 시스템은 TTL 또는 스케줄러를 통해 5분 초과된 예약을 자동 해제한다.
- 좌석 상태는 다시 "예약 가능"으로 변경된다.

---

## 7. 공통 제약 및 보장사항
- 모든 기능은 **대기열 토큰 검증을 통과한 유저만 사용 가능**
- 시스템은 **다중 인스턴스 환경**에서도 동작해야 하며, 동시성 문제를 방지해야 함
  - 예: DB Lock, 분산락, Redis 기반 제어
- **단위 테스트**는 각 기능별 최소 1개 이상 작성
- 추후 Redis, Kafka 기반 구조로 확장 예정